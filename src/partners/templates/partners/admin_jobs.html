<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Partner Jobs (Admin)</title>
    <style>pre{white-space:pre-wrap;border:1px solid #ccc;padding:8px;}</style>
  </head>
  <body>
    <h1>Partner Jobs</h1>
    <p><a href="/partner/admin">Back</a></p>
    <div id="summary">Loading...</div>
    <pre id="jobs"></pre>
    <script>
      async function load() {
        try {
          const r = await fetch('/partner/jobs', {credentials: 'same-origin'});
          if (!r.ok) {
            document.getElementById('summary').textContent = 'Failed to load jobs: ' + r.status;
            return;
          }
          const j = await r.json();
          document.getElementById('summary').textContent = `Counts: enqueued=${j.counts.pending}, in_progress=${j.counts.in_progress}, done=${j.counts.done}, failed=${j.counts.failed}`;
          document.getElementById('jobs').textContent = JSON.stringify(j.recent, null, 2);
        } catch (err) {
          document.getElementById('summary').textContent = 'Request error: ' + err;
        }
      }
      load();
    </script>
  </body>
</html>